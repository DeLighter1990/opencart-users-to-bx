# opencart-users-to-bx

## Перенос пользователей из Opencart 1.5 в Битрикс.

### Возможности:
- Перенос основных данных пользователей (ФИО, контакты, адрес)
- Авторизация пользователей в Битриксе по паролю из Opencart
- Создание заказа в Битриксе на общую сумму заказов пользователя в Opencart (для сохранения накопительных скидок)
- Предварительная проверка и вывод списка пользователей с некорректными email'ами и телефонами
- Приведение телефонов к формату +79000000000
- Обновление отличающихся данных при повторном запуске импорта

### Порядок действий:
До переноса:
- Скопировать файлы из папки **/opencart/** на сайт на Opencart, а файлы из папки **/bx/** на сайт на Битриксе. Файл init.php объединить с существующим. По адресу **https://ваш_сайт_на_opencart/index.php?route=api/getcustomers** будет доступна JSON-выгрузка данных пользователей Opencart.
- Отключить все почтовые уведомления пользователей на Битриксе
- Создать в Битриксе пользовательское поле **UF_OPENCART_PASSWORD_HASH** типа "Строка", где будет храниться хеш старого пароля с Opencart (hash:salt)
- В файле **/transfer/index.php** заменить **ваш_сайт_на_opencart** на реальный домен сайта на Opencart, а идентификатор сайта (**s1**) заменить на реальный идентификатор сайта, в который осуществляется импорт.
- На странице **https://ваш_сайт_на_битриксе/transfer/** будут доступны ссылки на списки пользователей с некорректными email'ами и номерами телефонов.

Перенос:
- Для запуска переноса нужно открыть страницу **https://ваш_сайт_на_битриксе/transfer/?action=import**. Если в процессе переноса возникают какие-либо ошибки, связанные с невозможностью сохранить данные пользователя из-за их дублирования или некорректного формата, рекомендуется исправлять такие данные на стороне Opencart. 

После переноса:
- Удалить файл /catalog/controller/api/getcustomers.php с сайта на Opencart
- Включить почтовые уведомления пользователей на Битриксе
